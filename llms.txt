# wqtrends

[![R-CMD-check](https://github.com/tbep-tech/wqtrends/workflows/R-CMD-check/badge.svg)](https://github.com/tbep-tech/wqtrends/actions)
[![pkgdown](https://github.com/tbep-tech/wqtrends/workflows/pkgdown/badge.svg)](https://github.com/tbep-tech/wqtrends/actions)
[![Codecov test
coverage](https://codecov.io/gh/tbep-tech/wqtrends/branch/master/graph/badge.svg)](https://app.codecov.io/gh/tbep-tech/wqtrends?branch=master)
[![CRAN
status](https://www.r-pkg.org/badges/version/wqtrends)](https://CRAN.R-project.org/package=wqtrends)
[![](https://cranlogs.r-pkg.org/badges/grand-total/wqtrends)](https://cran.r-project.org/package=wqtrends)
[![DOI](https://zenodo.org/badge/239808241.svg)](https://zenodo.org/badge/latestdoi/239808241)

R package to assess water quality trends for long-term monitoring data
in estuaries using Generalized Additive Models with error propagation
from mixed-effect meta-analysis. Uses concepts in the
[mgcv](https://CRAN.R-project.org/package=mgcv) and
[mixmeta](https://CRAN.R-project.org/package=mixmeta) packages. Detailed
information on the methods used in this package are described in the
following open access article:

*Beck, M.W., de Valpine, P., Murphy, R., Wren, I., Chelsky, A., Foley,
M., Senn, D.B. 2022. Multi-scale trend analysis of water quality using
error propagation of Generalized Additive Models. Science of the Total
Environment. 802:149927.
<https://doi.org/10.1016/j.scitotenv.2021.149927>*

## Installation

Install the package from CRAN as follows. The development version of the
package can be installed from
[r-universe](http://tbep-tech.r-universe.dev/#builds). The source code
is available on [GitHub](https://github.com/tbep-tech/wqtrends).

``` r
# Install wqtrends in R:
install.packages('wqtrends')

# load wqtrends
library(wqtrends)
```

# Issues and suggestions

Please report any issues and suggestions on the [issues
link](https://github.com/tbep-tech/wqtrends/issues) for the repository.

# Package index

## Analyze

- [`anlz_avgseason()`](https://tbep-tech.github.io/wqtrends/reference/anlz_avgseason.md)
  : Extract period (seasonal) averages from fitted GAM
- [`anlz_backtrans()`](https://tbep-tech.github.io/wqtrends/reference/anlz_backtrans.md)
  : Back-transform response variable
- [`anlz_fit()`](https://tbep-tech.github.io/wqtrends/reference/anlz_fit.md)
  : Return summary statistics for GAM fits
- [`anlz_gam()`](https://tbep-tech.github.io/wqtrends/reference/anlz_gam.md)
  : Fit a generalized additive model to a water quality time series
- [`anlz_metseason()`](https://tbep-tech.github.io/wqtrends/reference/anlz_metseason.md)
  : Extract period (seasonal) metrics from fitted GAM
- [`anlz_mixmeta()`](https://tbep-tech.github.io/wqtrends/reference/anlz_mixmeta.md)
  : Fit a mixed meta-analysis regression model of trends
- [`anlz_perchg()`](https://tbep-tech.github.io/wqtrends/reference/anlz_perchg.md)
  : Estimate percent change trends from GAM results for selected time
  periods
- [`anlz_prd()`](https://tbep-tech.github.io/wqtrends/reference/anlz_prd.md)
  : Get predicted data from fitted GAMs across period of observation
- [`anlz_prdday()`](https://tbep-tech.github.io/wqtrends/reference/anlz_prdday.md)
  : Get predicted data from fitted GAMs across period of observation,
  every day
- [`anlz_prdmatrix()`](https://tbep-tech.github.io/wqtrends/reference/anlz_prdmatrix.md)
  : Get prediction matrix for a fitted GAM
- [`anlz_pvalformat()`](https://tbep-tech.github.io/wqtrends/reference/anlz_pvalformat.md)
  : Format p-values for show functions
- [`anlz_smooth()`](https://tbep-tech.github.io/wqtrends/reference/anlz_smooth.md)
  : Return summary statistics for smoothers of GAMs
- [`anlz_sumstats()`](https://tbep-tech.github.io/wqtrends/reference/anlz_sumstats.md)
  : Retrieve summary statistics for seasonal metrics and trend results
- [`anlz_sumtrndseason()`](https://tbep-tech.github.io/wqtrends/reference/anlz_sumtrndseason.md)
  : Estimate seasonal rates of change based on average estimates for
  multiple window widths
- [`anlz_trans()`](https://tbep-tech.github.io/wqtrends/reference/anlz_trans.md)
  : Transform response variable
- [`anlz_trndseason()`](https://tbep-tech.github.io/wqtrends/reference/anlz_trndseason.md)
  : Estimate rates of change based on seasonal metrics

## Visualize

- [`show_metseason()`](https://tbep-tech.github.io/wqtrends/reference/show_metseason.md)
  : Plot period (seasonal) averages from fitted GAM
- [`show_mettrndseason()`](https://tbep-tech.github.io/wqtrends/reference/show_mettrndseason.md)
  : Plot seasonal metrics and rates of change
- [`show_perchg()`](https://tbep-tech.github.io/wqtrends/reference/show_perchg.md)
  : Plot percent change trends from GAM results for selected time
  periods
- [`show_prd3d()`](https://tbep-tech.github.io/wqtrends/reference/show_prd3d.md)
  : Plot a 3-d surface of predictions
- [`show_prddoy()`](https://tbep-tech.github.io/wqtrends/reference/show_prddoy.md)
  : Plot predictions for GAMs against day of year
- [`show_prdseason()`](https://tbep-tech.github.io/wqtrends/reference/show_prdseason.md)
  : Plot predictions for GAMs over time, by season
- [`show_prdseries()`](https://tbep-tech.github.io/wqtrends/reference/show_prdseries.md)
  : Plot predictions for GAMs over time series
- [`show_sumtrndseason()`](https://tbep-tech.github.io/wqtrends/reference/show_sumtrndseason.md)
  : Plot seasonal rates of change based on average estimates for
  multiple window widths
- [`show_sumtrndseason2()`](https://tbep-tech.github.io/wqtrends/reference/show_sumtrndseason2.md)
  : Plot seasonal rates of change in quarters based on average estimates
  for multiple window widths
- [`show_trndseason()`](https://tbep-tech.github.io/wqtrends/reference/show_trndseason.md)
  : Plot rates of change based on seasonal metrics

## Other

Other functions not defined by the concepts above

- [`rawdat`](https://tbep-tech.github.io/wqtrends/reference/rawdat.md) :
  Raw data from San Francisco Estuary (South Bay)

# Articles

### Get Started

- [Getting
  started](https://tbep-tech.github.io/wqtrends/articles/wqtrends.md):

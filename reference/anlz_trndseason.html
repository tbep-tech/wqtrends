<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Estimate seasonal rates of change based on average estimates — anlz_trndseason • wqtrends</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate seasonal rates of change based on average estimates — anlz_trndseason"><meta property="og:description" content="Estimate seasonal rates of change based on average estimates"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">wqtrends</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.0.9005</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/introduction.html">Introduction to wqtrends</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate seasonal rates of change based on average estimates</h1>
    
    <div class="hidden name"><code>anlz_trndseason.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimate seasonal rates of change based on average estimates</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">anlz_trndseason</span><span class="op">(</span>
  <span class="va">mod</span>,
  metfun <span class="op">=</span> <span class="va">mean</span>,
  doystr <span class="op">=</span> <span class="fl">1</span>,
  doyend <span class="op">=</span> <span class="fl">364</span>,
  justify <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"center"</span>, <span class="st">"left"</span>, <span class="st">"right"</span><span class="op">)</span>,
  win <span class="op">=</span> <span class="fl">5</span>,
  nsim <span class="op">=</span> <span class="fl">10000</span>,
  useave <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>mod</dt>
<dd><p>input model object as returned by <code><a href="anlz_gam.html">anlz_gam</a></code></p></dd>
<dt>metfun</dt>
<dd><p>function input for metric to calculate, e.g., <code>mean</code>, <code>var</code>, <code>max</code>, etc</p></dd>
<dt>doystr</dt>
<dd><p>numeric indicating start Julian day for extracting averages</p></dd>
<dt>doyend</dt>
<dd><p>numeric indicating ending Julian day for extracting averages</p></dd>
<dt>justify</dt>
<dd><p>chr string indicating the justification for the trend window</p></dd>
<dt>win</dt>
<dd><p>numeric indicating number of years to use for the trend window, see details</p></dd>
<dt>nsim</dt>
<dd><p>numeric indicating number of random draws for simulating uncertainty</p></dd>
<dt>useave</dt>
<dd><p>logical indicating if <code>anlz_avgseason</code> is used for the seasonal metric calculation</p></dd>
<dt>...</dt>
<dd><p>additional arguments passed to <code>metfun</code>, e.g., <code>na.rm = TRUE)</code></p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A data frame of slope estimates and p-values for each year</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Trends are based on the slope of the fitted linear trend within the window, where the linear trend is estimated using a meta-analysis regression model (from <code><a href="anlz_mixmeta.html">anlz_mixmeta</a></code>) for the seasonal metrics (from <code><a href="anlz_metseason.html">anlz_metseason</a></code>).</p>
<p>Note that for left and right windows, the exact number of years in <code>win</code> is used. For example, a left-centered window for 1990 of ten years will include exactly ten years from 1990, 1991, ... , 1999.  The same applies to a right-centered window, e.g., for 1990 it would include 1981, 1982, ..., 1990 (if those years have data). However, for a centered window, picking an even number of years for the window width will create a slightly off-centered window because it is impossible to center on an even number of years.  For example, if <code>win = 8</code> and <code>justify = 'center'</code>, the estimate for 2000 will be centered on 1997 to 2004 (three years left, four years right, eight years total). Centering for window widths with an odd number of years will always create a symmetrical window, i.e., if <code>win = 7</code> and <code>justify = 'center'</code>, the estimate for 2000 will be centered on 1997 and 2003 (three years left, three years right, seven years total).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other analyze: 
<code><a href="anlz_sumtrndseason.html">anlz_sumtrndseason</a>()</code>,
<code><a href="anlz_trans.html">anlz_trans</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># data to model</span></span>
<span class="r-in"><span class="va">tomod</span> <span class="op">&lt;-</span> <span class="va">rawdat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">station</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">34</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">param</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">'chl'</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="anlz_gam.html">anlz_gam</a></span><span class="op">(</span><span class="va">tomod</span>, trans <span class="op">=</span> <span class="st">'log10'</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">anlz_trndseason</span><span class="op">(</span><span class="va">mod</span>, doystr <span class="op">=</span> <span class="fl">90</span>, doyend <span class="op">=</span> <span class="fl">180</span>, justify <span class="op">=</span> <span class="st">'center'</span>, win <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 29 × 11</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       yr   met     se bt_lwr bt_upr bt_met    yrcoef     pval appr_yrcoef</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>  <span style="text-decoration: underline;">1</span>991 0.113 0.535   0.130  16.3    1.46 <span style="color: #BB0000;">NaN</span>       <span style="color: #BB0000;">NaN</span>          <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>  <span style="text-decoration: underline;">1</span>992 0.684 0.065<span style="text-decoration: underline;">5</span>  4.03    7.28   5.41 <span style="color: #BB0000;">NaN</span>       <span style="color: #BB0000;">NaN</span>          <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>  <span style="text-decoration: underline;">1</span>993 0.689 0.098<span style="text-decoration: underline;">5</span>  3.51    8.55   5.48 <span style="color: #BB0000;">NaN</span>       <span style="color: #BB0000;">NaN</span>          <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>  <span style="text-decoration: underline;">1</span>994 0.790 0.086<span style="text-decoration: underline;">4</span>  4.68   10.2    6.91   0.065<span style="text-decoration: underline;">5</span>    0.015<span style="text-decoration: underline;">1</span>      1.14  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>  <span style="text-decoration: underline;">1</span>995 0.728 0.079<span style="text-decoration: underline;">9</span>  4.18    8.59   5.99   0.058<span style="text-decoration: underline;">4</span>    0.010<span style="text-decoration: underline;">2</span>      1.16  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>  <span style="text-decoration: underline;">1</span>996 1.20  0.091<span style="text-decoration: underline;">1</span> 11.8    26.8   17.7    0.030<span style="text-decoration: underline;">9</span>    0.268       0.623 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>  <span style="text-decoration: underline;">1</span>997 0.835 0.090<span style="text-decoration: underline;">6</span>  5.10   11.6    7.68   0.004<span style="text-decoration: underline;">56</span>   0.872       0.094<span style="text-decoration: underline;">0</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>  <span style="text-decoration: underline;">1</span>998 1.02  0.079<span style="text-decoration: underline;">0</span>  8.30   16.9   11.9   -<span style="color: #BB0000;">0.003</span><span style="color: #BB0000; text-decoration: underline;">88</span>   0.887      -<span style="color: #BB0000;">0.083</span><span style="color: #BB0000; text-decoration: underline;">7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">1</span>999 1.05  0.154   6.25   25.1   12.5   -<span style="color: #BB0000;">0.038</span><span style="color: #BB0000; text-decoration: underline;">3</span>    0.049<span style="text-decoration: underline;">7</span>     -<span style="color: #BB0000;">0.847</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">2</span>000 0.811 0.097<span style="text-decoration: underline;">7</span>  4.67   11.3    7.25  -<span style="color: #BB0000;">0.017</span><span style="color: #BB0000; text-decoration: underline;">0</span>    0.263      -<span style="color: #BB0000;">0.335</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 19 more rows, and 2 more variables: yrcoef_lwr &lt;dbl&gt;, yrcoef_upr &lt;dbl&gt;</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Marcus Beck, Perry de Valpine, Rebecca Murphy, Ian Wren, Ariella Chelsky, Melissa Foley, David Senn.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>


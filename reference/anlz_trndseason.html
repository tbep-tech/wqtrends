<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate rates of change based on seasonal metrics — anlz_trndseason • wqtrends</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate rates of change based on seasonal metrics — anlz_trndseason"><meta name="description" content="Estimate rates of change based on seasonal metrics"><meta property="og:description" content="Estimate rates of change based on seasonal metrics"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">wqtrends</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/wqtrends.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tbep-tech/wqtrends/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Estimate rates of change based on seasonal metrics</h1>
      <small class="dont-index">Source: <a href="https://github.com/tbep-tech/wqtrends/blob/master/R/anlz_trndseason.R" class="external-link"><code>R/anlz_trndseason.R</code></a></small>
      <div class="d-none name"><code>anlz_trndseason.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimate rates of change based on seasonal metrics</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">anlz_trndseason</span><span class="op">(</span></span>
<span>  <span class="va">mod</span>,</span>
<span>  metfun <span class="op">=</span> <span class="va">mean</span>,</span>
<span>  doystr <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  doyend <span class="op">=</span> <span class="fl">364</span>,</span>
<span>  justify <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"center"</span>, <span class="st">"left"</span>, <span class="st">"right"</span><span class="op">)</span>,</span>
<span>  win <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  nsim <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  yromit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  useave <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-mod">mod<a class="anchor" aria-label="anchor" href="#arg-mod"></a></dt>
<dd><p>input model object as returned by <code><a href="anlz_gam.html">anlz_gam</a></code></p></dd>


<dt id="arg-metfun">metfun<a class="anchor" aria-label="anchor" href="#arg-metfun"></a></dt>
<dd><p>function input for metric to calculate, e.g., <code>mean</code>, <code>var</code>, <code>max</code>, etc</p></dd>


<dt id="arg-doystr">doystr<a class="anchor" aria-label="anchor" href="#arg-doystr"></a></dt>
<dd><p>numeric indicating start Julian day for extracting averages</p></dd>


<dt id="arg-doyend">doyend<a class="anchor" aria-label="anchor" href="#arg-doyend"></a></dt>
<dd><p>numeric indicating ending Julian day for extracting averages</p></dd>


<dt id="arg-justify">justify<a class="anchor" aria-label="anchor" href="#arg-justify"></a></dt>
<dd><p>chr string indicating the justification for the trend window</p></dd>


<dt id="arg-win">win<a class="anchor" aria-label="anchor" href="#arg-win"></a></dt>
<dd><p>numeric indicating number of years to use for the trend window, see details</p></dd>


<dt id="arg-nsim">nsim<a class="anchor" aria-label="anchor" href="#arg-nsim"></a></dt>
<dd><p>numeric indicating number of random draws for simulating uncertainty</p></dd>


<dt id="arg-yromit">yromit<a class="anchor" aria-label="anchor" href="#arg-yromit"></a></dt>
<dd><p>optional numeric vector for years to omit from the output</p></dd>


<dt id="arg-useave">useave<a class="anchor" aria-label="anchor" href="#arg-useave"></a></dt>
<dd><p>logical indicating if <code>anlz_avgseason</code> is used for the seasonal metric calculation, see details</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments passed to <code>metfun</code>, e.g., <code>na.rm = TRUE)</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame of slope estimates and p-values for each year</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Trends are based on the slope of the fitted linear trend within the window, where the linear trend is estimated using a meta-analysis regression model (from <code><a href="anlz_mixmeta.html">anlz_mixmeta</a></code>) for the seasonal metrics (from <code><a href="anlz_metseason.html">anlz_metseason</a></code>). Set <code>useave = T</code> to speed up calculations if <code>metfun = mean</code>.  This will use <code><a href="anlz_avgseason.html">anlz_avgseason</a></code> to estimate the seasonal summary metrics using a non-stochastic equation.</p>
<p>Note that for left and right windows, the exact number of years in <code>win</code> is used. For example, a left-centered window for 1990 of ten years will include exactly ten years from 1990, 1991, ... , 1999.  The same applies to a right-centered window, e.g., 1990 would include 1981, 1982, ..., 1990 (if those years have data). However, for a centered window, picking an even number of years for the window width will create a slightly off-centered window because it is impossible to center on an even number of years.  For example, if <code>win = 8</code> and <code>justify = 'center'</code>, the estimate for 2000 will be centered on 1997 to 2004 (three years left, four years right, eight years total). Centering for window widths with an odd number of years will always create a symmetrical window, i.e., if <code>win = 7</code> and <code>justify = 'center'</code>, the estimate for 2000 will be centered on 1997 and 2003 (three years left, three years right, seven years total).</p>
<p>The optional <code>yromit</code> vector can be used to omit years from the trend assessment. This may be preferred if seasonal estimates for a given year have very wide confidence intervals likely due to limited data, which can skew the trend assessments.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other analyze:
<code><a href="anlz_sumtrndseason.html">anlz_sumtrndseason</a>()</code>,
<code><a href="anlz_trans.html">anlz_trans</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># data to model</span></span></span>
<span class="r-in"><span><span class="va">tomod</span> <span class="op">&lt;-</span> <span class="va">rawdat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">station</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">34</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">param</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">'chl'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">yr</span> <span class="op">&gt;</span> <span class="fl">2015</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="anlz_gam.html">anlz_gam</a></span><span class="op">(</span><span class="va">tomod</span>, trans <span class="op">=</span> <span class="st">'log10'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">anlz_trndseason</span><span class="op">(</span><span class="va">mod</span>, doystr <span class="op">=</span> <span class="fl">90</span>, doyend <span class="op">=</span> <span class="fl">180</span>, justify <span class="op">=</span> <span class="st">'center'</span>, win <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 12</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      yr   met     se bt_lwr bt_upr bt_met dispersion   yrcoef    pval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">2</span>016 0.766 0.083<span style="text-decoration: underline;">3</span>   4.58   9.71   6.67     0.050<span style="text-decoration: underline;">4</span> <span style="color: #BB0000;">NaN</span>      <span style="color: #BB0000;">NaN</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">2</span>017 0.772 0.078<span style="text-decoration: underline;">6</span>   4.75   9.65   6.77     0.050<span style="text-decoration: underline;">4</span>   0.037<span style="text-decoration: underline;">3</span>   0.562</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>  <span style="text-decoration: underline;">2</span>018 1.03  0.072<span style="text-decoration: underline;">9</span>   8.77  16.9   12.2      0.050<span style="text-decoration: underline;">4</span> <span style="color: #BB0000;">NaN</span>      <span style="color: #BB0000;">NaN</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>  <span style="text-decoration: underline;">2</span>019 0.808 0.072<span style="text-decoration: underline;">1</span>   5.30  10.2    7.34     0.050<span style="text-decoration: underline;">4</span> <span style="color: #BB0000;">NaN</span>      <span style="color: #BB0000;">NaN</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 3 more variables: appr_yrcoef &lt;dbl&gt;, yrcoef_lwr &lt;dbl&gt;, yrcoef_upr &lt;dbl&gt;</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marcus Beck, Perry de Valpine, Rebecca Murphy, Ian Wren, Ariella Chelsky, Melissa Foley, David Senn.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

